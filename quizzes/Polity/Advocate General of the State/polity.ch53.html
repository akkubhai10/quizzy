<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>State Advocate General Quiz (Ch-53)</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-text: #ffffff;
            --secondary-text: #e0e0e0;
            --hindi-text: #dcdcdc;
            --accent-green: #00e676;
            --accent-red: #ff1744;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: 1px solid rgba(255, 255, 255, 0.2);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Poppins', sans-serif;
            /* Unique Cyan/Blue Gradient for this chapter */
            background: linear-gradient(135deg, #00c6ff, #0072ff);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 15px;
            overflow: hidden; 
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Glassmorphism Card */
        .app-container {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: var(--glass-border);
            border-radius: 25px;
            box-shadow: var(--glass-shadow);
            width: 100%;
            max-width: 600px;
            height: 90vh;
            padding: 20px;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        /* Screens */
        .screen {
            display: none;
            flex-direction: column;
            height: 100%;
            width: 100%;
            animation: fadeIn 0.5s ease;
            overflow: hidden; 
        }

        .screen.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Typography & Scroll */
        h1, h2 { color: var(--primary-text); text-align: center; margin-bottom: 20px; }
        p { color: var(--secondary-text); }

        .scroll-area {
            flex-grow: 1;
            overflow-y: auto;
            padding-right: 5px;
            margin-bottom: 15px;
            padding-bottom: 20px;
        }
        
        .scroll-area::-webkit-scrollbar { width: 6px; }
        .scroll-area::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 10px; }

        /* Start Screen Inputs */
        .input-group {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        label { color: var(--primary-text); font-weight: 600; }
        
        input[type="number"] {
            background: rgba(0,0,0,0.2);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 12px;
            padding: 12px;
            color: white;
            font-family: 'Poppins';
            font-size: 1rem;
            outline: none;
        }

        .toggle-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(0,0,0,0.2);
            padding: 10px 15px;
            border-radius: 12px;
        }

        /* Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(255,255,255,0.2);
            transition: .4s;
            border-radius: 24px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider { background-color: var(--accent-green); }
        input:checked + .slider:before { transform: translateX(26px); }

        /* Buttons */
        .btn-main {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 15px;
            border-radius: 15px;
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            width: 100%;
            margin-top: auto;
        }

        .btn-main:hover {
            transform: scale(1.02);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .btn-secondary {
            background: rgba(255, 23, 68, 0.8);
            margin-top: 10px;
            font-size: 0.9rem;
        }

        /* Quiz UI */
        .quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0;
        }

        .progress-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 4px;
            background: var(--accent-green);
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px var(--accent-green);
        }

        .timer-badge {
            background: rgba(0,0,0,0.3);
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            color: white;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .pulse-red {
            background: rgba(255, 23, 68, 0.8);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .question-box {
            margin-bottom: 20px;
            background: rgba(0,0,0,0.1);
            padding: 15px;
            border-radius: 15px;
        }

        .q-en {
            font-size: 1.1rem;
            font-weight: 700;
            color: white;
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .q-hi {
            font-size: 1rem;
            color: var(--hindi-text);
            font-weight: 400;
            line-height: 1.5;
        }

        .options-grid {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding-bottom: 10px;
        }

        .option-btn {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 12px 15px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
        }

        .option-btn:hover:not(:disabled) {
            background: rgba(255,255,255,0.15);
        }

        .option-btn.correct {
            background: rgba(0, 230, 118, 0.2);
            border-color: var(--accent-green);
            box-shadow: 0 0 10px rgba(0, 230, 118, 0.3);
        }

        .option-btn.wrong {
            background: rgba(255, 23, 68, 0.2);
            border-color: var(--accent-red);
        }

        .opt-en { font-size: 1rem; color: white; font-weight: 600; }
        .opt-hi { font-size: 0.9rem; color: var(--hindi-text); margin-top: 4px; }

        /* Effects */
        #effects-layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .emoji-feedback {
            font-size: 5rem;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .emoji-feedback.show {
            opacity: 1;
            transform: scale(1);
        }

        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        .score-display {
            font-size: 3rem;
            font-weight: 800;
            text-align: center;
            margin: 20px 0;
            background: linear-gradient(to right, #fff, #b3e5fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .result-message {
            text-align: center;
            font-size: 1.2rem;
            margin-bottom: 30px;
            color: #fff;
        }

        canvas {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 9999;
        }
    </style>
</head>
<body>

    <canvas id="confetti"></canvas>

    <div class="app-container">
        <div class="progress-bar" id="progress-bar"></div>

        <div id="start-screen" class="screen active">
            <h1>State Advocate General<br><span style="font-size: 0.6em; opacity: 0.8;">‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ</span></h1>
            
            <div class="scroll-area">
                <p style="text-align: center; margin-bottom: 20px;">Gyan Bindu G.S. Academy - Chapter 53</p>
                
                <div class="input-group">
                    <label>Timer per Question (Seconds)</label>
                    <input type="number" id="time-input" placeholder="e.g. 30 (Leave empty for no timer)">
                </div>

                <div class="toggle-container">
                    <label>Shuffle Questions</label>
                    <label class="switch">
                        <input type="checkbox" id="shuffle-toggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <button class="btn-main" onclick="startQuiz()">Start Quiz üöÄ</button>
        </div>

        <div id="quiz-screen" class="screen">
            <div class="quiz-header">
                <span id="q-counter">Q: 01/07</span>
                <span id="score-counter">Score: 0</span>
                <div id="timer-badge" class="timer-badge">
                    <span>‚è±</span> <span id="time-display">--</span>
                </div>
            </div>

            <div class="scroll-area">
                <div class="question-box">
                    <div id="question-en" class="q-en">Loading...</div>
                    <div id="question-hi" class="q-hi">Loading...</div>
                </div>

                <div id="options-container" class="options-grid">
                    </div>
            </div>

            <button class="btn-main btn-secondary" onclick="finishQuiz()">Finish & Show Results</button>
        </div>

        <div id="result-screen" class="screen">
            <h1>Quiz Result</h1>
            <div class="scroll-area" style="display: flex; flex-direction: column; justify-content: center;">
                <div class="score-display" id="final-score">0 / 7</div>
                <div class="result-message" id="result-msg">Calculating...</div>
            </div>
            <button class="btn-main" onclick="restartQuiz()">Restart Quiz üîÑ</button>
        </div>

        <div id="effects-layer">
            <div id="feedback-emoji" class="emoji-feedback"></div>
        </div>
    </div>

<script>
    // --- Data Source (Extracted from Screenshot 2026-01-13 110027.png) ---
    const rawQuestions = [
        {
            id: 1,
            q_en: "In which Article of the Constitution is the provision for State Advocate General made?",
            q_hi: "‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§ï‡•á ‡§ï‡§ø‡§∏ ‡§Ö‡§®‡•Å‡§ö‡•ç‡§õ‡•á‡§¶ ‡§Æ‡•á‡§Ç ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ ‡§ï‡•Ä ‡§ó‡§à ‡§π‡•à ?",
            options: [
                { en: "165", hi: "165" },
                { en: "166", hi: "166" },
                { en: "167", hi: "167" },
                { en: "168", hi: "168" }
            ],
            correct: 0 // (a)
        },
        {
            id: 2,
            q_en: "The highest law officer of the state is-",
            q_hi: "‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ï‡§æ ‡§∏‡§∞‡•ç‡§µ‡•ã‡§ö‡•ç‡§ö ‡§ï‡§æ‡§®‡•Ç‡§® ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à-",
            options: [
                { en: "Attorney General", hi: "‡§Æ‡§π‡§æ‡§®‡•ç‡§Ø‡§æ‡§Ø‡§µ‡§æ‡§¶‡•Ä" },
                { en: "Solicitor General", hi: "‡§∏‡•â‡§≤‡§ø‡§∏‡§ø‡§ü‡§∞ ‡§ú‡§®‡§∞‡§≤" },
                { en: "Advocate General", hi: "‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ" },
                { en: "None of these", hi: "‡§á‡§®‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡•ã‡§à ‡§®‡§π‡•Ä‡§Ç" }
            ],
            correct: 2 // (c)
        },
        {
            id: 3,
            q_en: "By whom is the Advocate General appointed?",
            q_hi: "‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ ‡§ï‡•Ä ‡§®‡§ø‡§Ø‡•Å‡§ï‡•ç‡§§‡§ø ‡§ï‡§ø‡§∏‡§ï‡•á ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§ï‡•Ä ‡§ú‡§æ‡§§‡•Ä ‡§π‡•à ?",
            options: [
                { en: "President", hi: "‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡§™‡§§‡§ø" },
                { en: "Chief Minister", hi: "‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä" },
                { en: "Governor", hi: "‡§∞‡§æ‡§ú‡•ç‡§Ø‡§™‡§æ‡§≤" },
                { en: "Deputy Chief Minister", hi: "‡§â‡§™‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä" }
            ],
            correct: 2 // (c)
        },
        {
            id: 4,
            q_en: "To become a State Advocate General, the qualification should be-",
            q_hi: "‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ ‡§¨‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§Ø‡•á ‡§Ø‡•ã‡§ó‡•ç‡§Ø‡§§‡§æ ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§Ø‡•á-",
            options: [
                { en: "He should be a citizen of India", hi: "‡§µ‡§π ‡§≠‡§æ‡§∞‡§§ ‡§ï‡§æ ‡§®‡§æ‡§ó‡§∞‡§ø‡§ï ‡§π‡•ã" },
                { en: "He should have 10 years of experience as an advocate", hi: "‡§â‡§∏‡•á 10 ‡§µ‡§∞‡•ç‡§∑ ‡§ï‡§æ ‡§µ‡§ï‡§æ‡§≤‡§§ ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§π‡•ã" },
                { en: "He should be a legal expert in the eyes of the Governor", hi: "‡§∞‡§æ‡§ú‡•ç‡§Ø‡§™‡§æ‡§≤ ‡§ï‡•Ä ‡§¶‡•É‡§∑‡•ç‡§ü‡§ø ‡§Æ‡•á‡§Ç ‡§µ‡§ø‡§ß‡§ø ‡§ï‡§æ ‡§ú‡•ç‡§û‡§æ‡§§‡§æ ‡§π‡•ã" },
                { en: "All of the above", hi: "‡§â‡§™‡§∞‡•ç‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§Æ‡•á‡§Ç ‡§∏‡§≠‡•Ä" }
            ],
            correct: 3 // (d)
        },
        {
            id: 5,
            q_en: "How many years has the tenure of the Advocate General been fixed by the Constitution?",
            q_hi: "‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§¶‡•ç‡§µ‡§æ‡§∞‡§æ ‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ ‡§ï‡§æ ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§ï‡§æ‡§≤ ‡§ï‡§ø‡§§‡§®‡•á ‡§µ‡§∞‡•ç‡§∑ ‡§§‡§Ø ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à ?",
            options: [
                { en: "4 years", hi: "4 ‡§µ‡§∞‡•ç‡§∑" },
                { en: "5 years", hi: "5 ‡§µ‡§∞‡•ç‡§∑" },
                { en: "6 years", hi: "6 ‡§µ‡§∞‡•ç‡§∑" },
                { en: "Not fixed", hi: "‡§®‡§ø‡§∞‡•ç‡§ß‡§æ‡§∞‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç" }
            ],
            correct: 3 // (d)
        },
        {
            id: 6,
            q_en: "The State Advocate General holds office during the pleasure of whom?",
            q_hi: "‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ ‡§ï‡§ø‡§∏‡§ï‡•á ‡§™‡•ç‡§∞‡§∏‡§æ‡§¶‡§™‡§∞‡•ç‡§Ø‡§Ç‡§§ ‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§ï‡§∞‡§§‡§æ ‡§π‡•à ?",
            options: [
                { en: "Governor", hi: "‡§∞‡§æ‡§ú‡•ç‡§Ø‡§™‡§æ‡§≤" },
                { en: "Chief Minister", hi: "‡§Æ‡•Å‡§ñ‡•ç‡§Ø‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä" },
                { en: "Law Minister", hi: "‡§µ‡§ø‡§ß‡§ø ‡§Æ‡§Ç‡§§‡•ç‡§∞‡•Ä" },
                { en: "President", hi: "‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡§™‡§§‡§ø" }
            ],
            correct: 0 // (a)
        },
        {
            id: 7,
            q_en: "Identify the correct statement among the following regarding the State Advocate General.\n1. He has the right to participate in the proceedings of the State Legislature.\n2. He also has the right to vote in the Legislature.",
            q_hi: "‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§Æ‡§π‡§æ‡§ß‡§ø‡§µ‡§ï‡•ç‡§§‡§æ ‡§ï‡•á ‡§∏‡§Ç‡§¶‡§∞‡•ç‡§≠ ‡§Æ‡•á‡§Ç ‡§®‡§ø‡§Æ‡•ç‡§®‡§≤‡§ø‡§ñ‡§ø‡§§ ‡§ï‡§•‡§®‡•ã‡§Ç ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§∏‡§π‡•Ä ‡§ï‡§•‡§® ‡§ï‡•Ä ‡§™‡§π‡§ö‡§æ‡§® ‡§ï‡•Ä‡§ú‡§ø‡§Ø‡•á‡•§\n1. ‡§â‡§∏‡•á ‡§∞‡§æ‡§ú‡•ç‡§Ø‡§µ‡§ø‡§ß‡§æ‡§® ‡§Æ‡§Ç‡§°‡§≤ ‡§ï‡•Ä ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§µ‡§æ‡§π‡•Ä ‡§Æ‡•á‡§Ç ‡§≠‡§æ‡§ó ‡§≤‡•á‡§®‡•á ‡§ï‡§æ ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§π‡•à‡•§\n2. ‡§â‡§∏‡•á ‡§µ‡§ø‡§ß‡§æ‡§®‡§Æ‡§Ç‡§°‡§≤ ‡§Æ‡•á‡§Ç ‡§Æ‡§§‡§¶‡§æ‡§® ‡§ï‡•Ä ‡§≠‡•Ä ‡§Ö‡§ß‡§ø‡§ï‡§æ‡§∞ ‡§π‡•à‡•§",
            options: [
                { en: "Only 1", hi: "‡§ï‡•á‡§µ‡§≤ 1" },
                { en: "Only 2", hi: "‡§ï‡•á‡§µ‡§≤ 2" },
                { en: "1 and 2", hi: "1 ‡§î‡§∞ 2" },
                { en: "Neither 1 nor 2", hi: "‡§® ‡§§‡•ã 1 ‡§® ‡§π‡•Ä 2" }
            ],
            correct: 0 // (a)
        }
    ];

    // --- State Variables ---
    let currentQuestions = [];
    let currentIndex = 0;
    let score = 0;
    let timerInterval;
    let timerValue = 0;
    let isTimerEnabled = false;
    
    // --- Audio System (Web Audio API) ---
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    
    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        if (type === 'correct') {
            // Ting sound (High Sine)
            osc.type = 'sine';
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); 
            osc.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        } else {
            // Buzz sound (Low Sawtooth)
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.4);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.4);
        }
    }

    // --- Core Logic ---

    function startQuiz() {
        const timeInput = document.getElementById('time-input').value;
        const shuffle = document.getElementById('shuffle-toggle').checked;

        // Clone questions
        currentQuestions = [...rawQuestions];
        
        if (shuffle) {
            currentQuestions.sort(() => Math.random() - 0.5);
        }

        timerValue = parseInt(timeInput);
        isTimerEnabled = !isNaN(timerValue) && timerValue > 0;

        currentIndex = 0;
        score = 0;
        document.getElementById('start-screen').classList.remove('active');
        document.getElementById('quiz-screen').classList.add('active');
        
        loadQuestion();
    }

    function loadQuestion() {
        if (currentIndex >= currentQuestions.length) {
            finishQuiz();
            return;
        }

        // Reset UI
        clearInterval(timerInterval);
        document.getElementById('timer-badge').classList.remove('pulse-red');
        document.getElementById('feedback-emoji').classList.remove('show', 'shake');
        
        // Progress
        const progress = ((currentIndex) / currentQuestions.length) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;
        document.getElementById('q-counter').textContent = `Q: ${currentIndex + 1}/${currentQuestions.length}`;
        document.getElementById('score-counter').textContent = `Score: ${score}`;

        // Load Content
        const qData = currentQuestions[currentIndex];
        document.getElementById('question-en').innerText = qData.q_en;
        document.getElementById('question-hi').innerText = qData.q_hi;

        const optsContainer = document.getElementById('options-container');
        optsContainer.innerHTML = '';

        qData.options.forEach((opt, index) => {
            const btn = document.createElement('button');
            btn.className = 'option-btn';
            btn.innerHTML = `<span class="opt-en">${String.fromCharCode(97+index)}. ${opt.en}</span><span class="opt-hi">${opt.hi}</span>`;
            btn.onclick = () => handleAnswer(index, btn);
            optsContainer.appendChild(btn);
        });

        // Timer Logic
        if (isTimerEnabled) {
            let timeLeft = timerValue;
            document.getElementById('time-display').textContent = timeLeft + "s";
            
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('time-display').textContent = timeLeft + "s";
                
                if (timeLeft < 5) {
                    document.getElementById('timer-badge').classList.add('pulse-red');
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    autoFail(); // Time ran out
                }
            }, 1000);
        } else {
            document.getElementById('time-display').textContent = "‚àû";
        }
    }

    function handleAnswer(selectedIndex, btnElement) {
        clearInterval(timerInterval); // Stop timer
        
        // Disable all buttons
        const allBtns = document.querySelectorAll('.option-btn');
        allBtns.forEach(b => b.disabled = true);

        const correctIndex = currentQuestions[currentIndex].correct;
        const emojiEl = document.getElementById('feedback-emoji');

        if (selectedIndex === correctIndex) {
            // Correct
            score++;
            btnElement.classList.add('correct');
            playSound('correct');
            fireConfetti();
            emojiEl.innerText = "ü§©"; 
            emojiEl.classList.add('show');
        } else {
            // Wrong
            btnElement.classList.add('wrong');
            allBtns[correctIndex].classList.add('correct'); // Show right answer
            playSound('wrong');
            emojiEl.innerText = "üò¢"; 
            emojiEl.classList.add('show', 'shake');
        }

        // Auto transition
        setTimeout(() => {
            currentIndex++;
            loadQuestion();
        }, 1500);
    }

    function autoFail() {
        const allBtns = document.querySelectorAll('.option-btn');
        allBtns.forEach(b => b.disabled = true);
        const correctIndex = currentQuestions[currentIndex].correct;
        allBtns[correctIndex].classList.add('correct');
        
        const emojiEl = document.getElementById('feedback-emoji');
        emojiEl.innerText = "‚è∞";
        emojiEl.classList.add('show', 'shake');
        playSound('wrong');

        setTimeout(() => {
            currentIndex++;
            loadQuestion();
        }, 1500);
    }

    function finishQuiz() {
        clearInterval(timerInterval);
        document.getElementById('quiz-screen').classList.remove('active');
        document.getElementById('result-screen').classList.add('active');
        document.getElementById('progress-bar').style.width = '100%';

        const total = currentQuestions.length;
        const percentage = (score / total) * 100;

        document.getElementById('final-score').innerText = `${score} / ${total}`;
        
        const msgEl = document.getElementById('result-msg');
        if (percentage >= 80) {
            msgEl.innerText = "üèÜ Outstanding Performance!";
        } else if (percentage >= 50) {
            msgEl.innerText = "üëè Well Done! Keep it up.";
        } else {
            msgEl.innerText = "üìö Practice makes perfect! Try again.";
        }
    }

    function restartQuiz() {
        document.getElementById('result-screen').classList.remove('active');
        document.getElementById('start-screen').classList.add('active');
    }

    // --- Confetti Logic (Canvas) ---
    const confettiCanvas = document.getElementById('confetti');
    const ctx = confettiCanvas.getContext('2d');
    let particles = [];

    function resizeCanvas() {
        confettiCanvas.width = window.innerWidth;
        confettiCanvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    function fireConfetti() {
        for(let i=0; i<100; i++) {
            particles.push({
                x: window.innerWidth / 2,
                y: window.innerHeight / 2,
                w: Math.random() * 10 + 5,
                h: Math.random() * 10 + 5,
                vx: Math.random() * 10 - 5,
                vy: Math.random() * 10 - 5,
                color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                life: 100
            });
        }
    }

    function animateConfetti() {
        ctx.clearRect(0,0, confettiCanvas.width, confettiCanvas.height);
        
        for(let i=0; i<particles.length; i++) {
            let p = particles[i];
            p.x += p.vx;
            p.y += p.vy;
            p.vy += 0.2; // gravity
            p.life--;
            
            ctx.fillStyle = p.color;
            ctx.fillRect(p.x, p.y, p.w, p.h);

            if(p.life <= 0) {
                particles.splice(i, 1);
                i--;
            }
        }
        requestAnimationFrame(animateConfetti);
    }
    animateConfetti();

</script>
</body>
</html>